% =============================================================================
% TESIS DE MAESTRIA EN INGENIERIA ELECTRONICA
% =============================================================================
% Titulo: Prediccion de Landmarks Anatomicos en Radiografias de Torax
%         mediante Deep Learning
% Autor: [Nombre del Autor]
% Director: [Nombre del Director]
% Universidad: [Nombre de la Universidad]
% Fecha: Noviembre 2024
% =============================================================================

\documentclass[12pt,twoside,openright]{book}

% Cargar configuracion de paquetes
\input{config/preamble}

% =============================================================================
% METADATOS DEL DOCUMENTO
% =============================================================================
\hypersetup{
    pdftitle={Prediccion de Landmarks Anatomicos en Radiografias de Torax mediante Deep Learning},
    pdfauthor={[Nombre del Autor]},
    pdfsubject={Tesis de Maestria en Ingenieria Electronica},
    pdfkeywords={Deep Learning, Landmarks, Radiografias, ResNet, Computer Vision, Medical Imaging}
}

% =============================================================================
% INICIO DEL DOCUMENTO
% =============================================================================
\begin{document}

% -----------------------------------------------------------------------------
% PAGINAS PRELIMINARES (numeracion romana)
% -----------------------------------------------------------------------------
\frontmatter
\pagestyle{plain}

% Portada
\begin{titlepage}
    \centering

    % Logo de la universidad (descomentar cuando se tenga)
    % \includegraphics[width=0.3\textwidth]{figures/logo_universidad.png}

    \vspace{1cm}

    {\Large\bfseries [NOMBRE DE LA UNIVERSIDAD]}

    \vspace{0.5cm}

    {\large Facultad de Ingenieria}

    \vspace{0.3cm}

    {\large Maestria en Ingenieria Electronica}

    \vspace{2cm}

    \rule{\textwidth}{1.5pt}

    \vspace{0.5cm}

    {\LARGE\bfseries Prediccion de Landmarks Anatomicos en Radiografias de Torax mediante Deep Learning}

    \vspace{0.5cm}

    \rule{\textwidth}{1.5pt}

    \vspace{2cm}

    {\large Tesis presentada para obtener el grado de}

    \vspace{0.3cm}

    {\Large\bfseries Maestro en Ingenieria Electronica}

    \vspace{2cm}

    {\large Presenta:}

    \vspace{0.3cm}

    {\Large [Nombre del Autor]}

    \vspace{1.5cm}

    {\large Director de Tesis:}

    \vspace{0.3cm}

    {\Large Dr. [Nombre del Director]}

    \vfill

    {\large [Ciudad], [Pais]}

    \vspace{0.3cm}

    {\large Noviembre 2024}

\end{titlepage}

% Pagina en blanco despues de portada
\cleardoublepage

% -----------------------------------------------------------------------------
% DEDICATORIA (opcional)
% -----------------------------------------------------------------------------
\chapter*{Dedicatoria}
\thispagestyle{empty}
\vspace*{5cm}
\begin{flushright}
    \textit{A mi familia, por su apoyo incondicional.}
\end{flushright}
\cleardoublepage

% -----------------------------------------------------------------------------
% AGRADECIMIENTOS
% -----------------------------------------------------------------------------
\chapter*{Agradecimientos}
\addcontentsline{toc}{chapter}{Agradecimientos}

Agradezco profundamente a mi director de tesis, Dr. [Nombre], por su guia experta y su constante apoyo durante el desarrollo de este trabajo.

A la [Universidad/Institucion], por proporcionar los recursos computacionales necesarios para el entrenamiento de los modelos de deep learning.

A mis companeros del laboratorio de [Nombre del Laboratorio], por las valiosas discusiones y retroalimentacion que enriquecieron esta investigacion.

A los revisores y desarrolladores de las bibliotecas de codigo abierto PyTorch, OpenCV y las demas herramientas utilizadas, sin las cuales este trabajo no habria sido posible.

Finalmente, a mi familia, por su paciencia y apoyo incondicional durante todo este proceso.

\cleardoublepage

% -----------------------------------------------------------------------------
% RESUMEN EN ESPANOL
% -----------------------------------------------------------------------------
\chapter*{Resumen}
\addcontentsline{toc}{chapter}{Resumen}

\textbf{Palabras clave:} Deep Learning, Landmarks Anatomicos, Radiografias de Torax, ResNet, Coordinate Attention, Wing Loss, Ensemble Learning.

\vspace{1cm}

La deteccion automatica de landmarks anatomicos en imagenes medicas es fundamental para el diagnostico asistido por computadora y la planificacion de tratamientos. En este trabajo se presenta un sistema de deep learning para la prediccion de 15 landmarks anatomicos en radiografias de torax, abordando los desafios particulares que presentan las imagenes de pacientes con COVID-19 y neumonia viral.

Se desarrollo una arquitectura basada en ResNet-18 con un modulo de Coordinate Attention y una cabeza de regresion profunda optimizada. El sistema incorpora un preprocesamiento con CLAHE (Contrast Limited Adaptive Histogram Equalization) que mejora significativamente la deteccion en casos con consolidaciones pulmonares. La funcion de perdida Wing Loss demostro ser superior a MSE para este problema de regresion de coordenadas.

El modelo final consiste en un ensemble de 4 redes entrenadas con diferentes inicializaciones, combinado con Test-Time Augmentation (TTA). Sobre un dataset de 957 radiografias divididas en entrenamiento (717), validacion (144) y prueba (96), se logro un error promedio de \textbf{3.71 pixeles}, lo que representa una mejora del \textbf{59\%} respecto al baseline inicial de 9.08 pixeles. Este resultado supera ampliamente el objetivo original de $<$8 pixeles y se acerca al limite teorico impuesto por el ruido inherente del etiquetado manual ($\sim$1.5-2.0 pixeles).

El analisis detallado revela que los landmarks centrales (L9, L10) son los mas precisos (2.64-2.83 px), mientras que los senos costofrenicos (L14, L15) representan el mayor desafio (4.46-4.82 px). CLAHE resulto particularmente efectivo para casos de COVID-19, reduciendo el error en esa categoria de 11.74 a 3.80 pixeles (-68\%).

Los resultados demuestran que las tecnicas modernas de deep learning pueden alcanzar precision clinicamente util en la deteccion de landmarks anatomicos, con potencial aplicacion en sistemas de diagnostico asistido.

\cleardoublepage

% -----------------------------------------------------------------------------
% ABSTRACT EN INGLES
% -----------------------------------------------------------------------------
\chapter*{Abstract}
\addcontentsline{toc}{chapter}{Abstract}

\textbf{Keywords:} Deep Learning, Anatomical Landmarks, Chest X-rays, ResNet, Coordinate Attention, Wing Loss, Ensemble Learning.

\vspace{1cm}

Automatic detection of anatomical landmarks in medical images is fundamental for computer-aided diagnosis and treatment planning. This work presents a deep learning system for predicting 15 anatomical landmarks in chest X-rays, addressing the particular challenges posed by images from patients with COVID-19 and viral pneumonia.

An architecture based on ResNet-18 was developed, incorporating a Coordinate Attention module and an optimized deep regression head. The system includes CLAHE (Contrast Limited Adaptive Histogram Equalization) preprocessing, which significantly improves detection in cases with pulmonary consolidations. Wing Loss proved superior to MSE for this coordinate regression problem.

The final model consists of an ensemble of 4 networks trained with different initializations, combined with Test-Time Augmentation (TTA). On a dataset of 957 radiographs divided into training (717), validation (144), and test (96) sets, an average error of \textbf{3.71 pixels} was achieved, representing a \textbf{59\%} improvement over the initial baseline of 9.08 pixels. This result far exceeds the original goal of $<$8 pixels and approaches the theoretical limit imposed by inherent manual labeling noise ($\sim$1.5-2.0 pixels).

Detailed analysis reveals that central landmarks (L9, L10) are the most accurate (2.64-2.83 px), while costophrenic angles (L14, L15) represent the greatest challenge (4.46-4.82 px). CLAHE proved particularly effective for COVID-19 cases, reducing error in that category from 11.74 to 3.80 pixels (-68\%).

Results demonstrate that modern deep learning techniques can achieve clinically useful precision in anatomical landmark detection, with potential application in assisted diagnostic systems.

\cleardoublepage

% -----------------------------------------------------------------------------
% INDICES
% -----------------------------------------------------------------------------

% Indice general
\tableofcontents
\cleardoublepage

% Lista de figuras
\listoffigures
\addcontentsline{toc}{chapter}{Lista de Figuras}
\cleardoublepage

% Lista de tablas
\listoftables
\addcontentsline{toc}{chapter}{Lista de Tablas}
\cleardoublepage

% Lista de algoritmos
\listofalgorithms
\addcontentsline{toc}{chapter}{Lista de Algoritmos}
\cleardoublepage

% Lista de codigos
\lstlistoflistings
\addcontentsline{toc}{chapter}{Lista de Codigos}
\cleardoublepage

% -----------------------------------------------------------------------------
% LISTA DE SIMBOLOS Y ABREVIATURAS
% -----------------------------------------------------------------------------
\chapter*{Lista de Simbolos y Abreviaturas}
\addcontentsline{toc}{chapter}{Lista de Simbolos y Abreviaturas}

\section*{Simbolos}

\begin{tabular}{@{}ll@{}}
    $\vec{x}$ & Vector de entrada \\
    $\vec{y}$ & Vector de salida (coordenadas de landmarks) \\
    $\hat{\vec{y}}$ & Vector de predicciones \\
    $\mathcal{L}$ & Funcion de perdida \\
    $\omega$ & Parametro de umbral en Wing Loss \\
    $\epsilon$ & Parametro de curvatura en Wing Loss \\
    $\theta$ & Parametros del modelo \\
    $\eta$ & Tasa de aprendizaje (learning rate) \\
    $\sigma$ & Desviacion estandar \\
    $t$ & Parametro de posicion sobre el eje central \\
\end{tabular}

\section*{Abreviaturas}

\begin{tabular}{@{}ll@{}}
    \CNN & Convolutional Neural Network (Red Neuronal Convolucional) \\
    \CLAHE & Contrast Limited Adaptive Histogram Equalization \\
    \TTA & Test-Time Augmentation \\
    FC & Fully Connected (Completamente Conectada) \\
    GAP & Global Average Pooling \\
    GPU & Graphics Processing Unit \\
    MSE & Mean Squared Error \\
    \ResNet & Residual Network \\
    ReLU & Rectified Linear Unit \\
    SGD & Stochastic Gradient Descent \\
    Adam & Adaptive Moment Estimation \\
    ROC & Receiver Operating Characteristic \\
    px & Pixeles \\
\end{tabular}

\cleardoublepage

% -----------------------------------------------------------------------------
% CUERPO PRINCIPAL (numeracion arabiga)
% -----------------------------------------------------------------------------
\mainmatter
\pagestyle{fancy}

% Capitulos
\include{chapters/01_introduccion}
\include{chapters/02_marco_teorico}
\include{chapters/03_estado_del_arte}
\include{chapters/04_metodologia}
\include{chapters/05_experimentacion}
\include{chapters/06_discusion}
\include{chapters/07_conclusiones}

% -----------------------------------------------------------------------------
% BIBLIOGRAFIA
% -----------------------------------------------------------------------------
\backmatter

\printbibliography[heading=bibintoc,title={Referencias Bibliograficas}]

% -----------------------------------------------------------------------------
% APENDICES
% -----------------------------------------------------------------------------
\begin{appendices}
    \include{appendices/A_codigo}
    \include{appendices/B_hiperparametros}
    \include{appendices/C_visualizaciones}
\end{appendices}

% =============================================================================
% FIN DEL DOCUMENTO
% =============================================================================
\end{document}
