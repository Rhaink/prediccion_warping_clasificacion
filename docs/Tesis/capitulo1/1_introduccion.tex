% =============================================================================
% CAPITULO 1: INTRODUCCION
% =============================================================================

\chapter{Introducci\'on}
\label{cap:introduccion}

La neumon\'ia representa una de las principales causas de mortalidad a nivel mundial, con millones de casos anuales que requieren diagn\'ostico oportuno y preciso. La pandemia de COVID-19 evidenci\'o la necesidad cr\'itica de m\'etodos de detecci\'on autom\'atica basados en radiograf\'ias de t\'orax, especialmente en entornos con acceso a recursos limitado. Los sistemas de diagn\'ostico automatizado deben alcanzar niveles de exactitud y robustez suficientes para apoyar efectivamente la toma de decisiones cl\'inicas, reduciendo la variabilidad inherente en la interpretaci\'on manual de im\'agenes radiogr\'aficas \cite{who2020chest}.

La clasificaci\'on err\'onea de neumon\'ia tiene consecuencias significativas: un falso negativo en COVID-19 puede resultar en propagaci\'on inadvertida de la enfermedad, mientras que un falso positivo genera costos innecesarios. Para ser cl\'inicamente viables, los sistemas automatizados deben demostrar no solo alta precisi\'on sino tambi\'en robustez ante la variabilidad en la adquisici\'on de im\'agenes, incluyendo diferencias en el posicionamiento del paciente, distancia de proyecci\'on, calibraci\'on de equipos y condiciones de respiraci\'on.

En este contexto, las t\'ecnicas de visi\'on por computadora y aprendizaje profundo ofrecen una v\'ia prometedora para el desarrollo de sistemas de apoyo al diagn\'ostico. Sin embargo, la variabilidad extr\'inseca en la adquisici\'on de radiograf\'ias representa un desaf\'io significativo para la generalizaci\'on de modelos. Este trabajo aborda dicho desaf\'io mediante normalizaci\'on geom\'etrica de la regi\'on pulmonar, con el objetivo de reducir variabilidad de pose, facilitando el aprendizaje de caracter\'isticas patol√≥gicas.

\section{Trabajo Relacionado}
\label{sec:trabajo_relacionado}

Diversos trabajos han propuesto m\'etodos de detecci\'on autom\'atica de COVID-19 y neumon\'ia mediante aprendizaje profundo aplicado directamente sobre radiograf\'ias de t\'orax. Wang et al. \cite{wang2020covidnet} desarrollaron COVIDNet, una arquitectura dise\~nada espec\'ificamente para clasificaci\'on multi-clase de COVID-19, neumon\'ia viral y neumon\'ia bacteriana. Rajpurkar et al. \cite{rajpurkar2017chexnet} demostraron que CheXNet, basada en DenseNet-121, alcanza performance comparable a radi\'ologos en detecci\'on de neumon\'ia. Chowdhury et al. \cite{chowdhury2020can} compilaron el COVID-19 Radiography Database utilizado en este trabajo, facilitando investigaci\'on reproducible. Rahman et al. \cite{rahman2021exploring} exploraron t\'ecnicas de mejora de imagen para detecci\'on de COVID-19, evaluando m\'etodos de preprocesamiento. Estos enfoques aplican redes convolucionales sobre im\'agenes originales o con preprocesamiento de contraste, sin normalizaci\'on geom\'etrica expl\'icita.

Trabajos recientes han demostrado que la normalizaci\'on geom\'etrica puede mejorar significativamente el rendimiento de clasificadores m\'edicos. Picazo-Castillo et al. \cite{picazo2024comparative} presentaron un estudio comparativo de representaciones de im\'agenes pulmonares para reconocimiento autom\'atico de neumon\'ia, demostrando que diferentes estrategias de normalizaci\'on espacial afectan la capacidad de generalizaci\'on de modelos CNN. Ayala-Raggi et al. \cite{ayala2023synergizing} propusieron la integraci\'on de normalizaci\'on de im\'agenes de t\'orax con selecci\'on discriminativa de caracter\'isticas para reconocimiento eficiente de COVID-19, logrando mejoras en exactitud mediante la reducci\'on de variabilidad extr\'inseca. Rocha et al. \cite{rocha2024stern} desarrollaron STERN, una red que combina Spatial Transformer Networks con mecanismos de atenci\'on para detecci\'on de anomal\'ias en radiograf\'ias de t\'orax, permitiendo alineaci\'on impl\'icita de regiones anat\'omicas. Yeh et al. \cite{yeh2021deep} demostraron que la detecci\'on autom\'atica de puntos de referencia anat\'omicos y su uso para an\'alisis de alineaci\'on mejora significativamente el diagn\'ostico en radiograf\'ias de columna vertebral.

La evidencia acumulada sugiere que la normalizaci\'on geom\'etrica es una estrategia efectiva para mejorar sistemas de clasificaci\'on en imagen m\'edica. Sin embargo, los trabajos previos se limitan a transformaciones r\'igidas (rotaci\'on, traslaci\'on) o afines globales, que asumen uniformidad en la deformaci\'on del tejido pulmonar, una suposici\'on inexacta dado que el pulm\'on es un \'organo deformable cuya forma var\'ia seg\'un la fase respiratoria, posici\'on del paciente y patolog\'ia subyacente. Este trabajo explora la hip\'otesis de que la normalizaci\'on mediante \textit{deformaci\'on af\'in por partes}, que permite deformaci\'on local preservando estructura triangular, puede eliminar variabilidad de pose sin sacrificar informaci\'on diagn\'ostica contenida en la textura pulmonar, adaptando la regi\'on pulmonar a una forma est\'andar com\'un.

\section{Justificaci\'on}
\label{sec:justificacion}

El presente trabajo propone un m\'etodo de normalizaci\'on geom\'etrica basado en \textit{deformaci\'on af\'in por partes} que, a diferencia de los enfoques previos limitados a transformaciones r\'igidas o afines globales, permite deformaci\'on local adaptativa de la regi\'on pulmonar. Esta estrategia ofrece mayor flexibilidad al adaptar cada regi\'on a una geometr\'ia com\'un sin asumir uniformidad en la deformaci\'on, preservando informaci\'on diagn\'ostica local mientras se normaliza la variabilidad extr\'inseca de pose y fase respiratoria. Mediante la detecci\'on autom\'atica de 15 puntos de referencia anat\'omicos que definen el contorno pulmonar, se establece correspondencia geom\'etrica entre cada imagen y una forma est\'andar obtenida mediante An\'alisis General de Procrustes, aplicando transformaciones afines independientes a cada tri\'angulo de una malla de Delaunay. La hip\'otesis central es que esta normalizaci\'on facilita el aprendizaje de caracter\'isticas intr\'insecas relacionadas con patolog\'ia (opacidades en vidrio esmerilado, consolidaciones, infiltrados intersticiales) al reducir la complejidad del espacio de variaci\'on que debe modelar el clasificador.

\section{Contribuciones del Trabajo}
\label{sec:contribuciones}

El sistema propuesto integra t\'ecnicas de aprendizaje profundo, an\'alisis de forma y geometr\'ia computacional en un proceso completo que comprende dos fases principales. La primera fase, denominada fase de preparaci\'on, incluye la anotaci\'on manual de puntos de referencia anat\'omicos en un subconjunto representativo de im\'agenes y el entrenamiento de los modelos de redes neuronales para detecci\'on de puntos de referencia y clasificaci\'on. La segunda fase, denominada fase de operaci\'on, procesa nuevas radiograf\'ias mediante cuatro m\'odulos secuenciales. El m\'odulo de preprocesamiento normaliza las variaciones de contraste mediante CLAHE (\textit{Contrast Limited Adaptive Histogram Equalization}) y redimensiona las im\'agenes a formato est\'andar. El m\'odulo de predicci\'on de puntos de referencia emplea una red ResNet-18 con Coordinate Attention para estimar autom\'aticamente las coordenadas de 15 puntos anat\'omicos que definen el contorno pulmonar bilateral. El m\'odulo de normalizaci\'on geom\'etrica utiliza los puntos de referencia predichos para aplicar \textit{deformaci\'on af\'in por partes}, alineando cada imagen a una forma est\'andar pulmonar previamente calculada mediante An\'alisis General de Procrustes sobre las configuraciones del conjunto de entrenamiento, generando correspondencias geom\'etricas mediante triangulaci\'on de Delaunay y aplicando transformaciones afines independientes a cada tri\'angulo. Finalmente, el m\'odulo de clasificaci\'on procesa las im\'agenes normalizadas mediante una red ResNet-18 que discrimina entre COVID-19, neumon\'ia viral y casos normales, operando sobre representaciones geom\'etricamente consistentes que facilitan la identificaci\'on de patrones diagn\'osticos intr\'insecos.

\section{Estructura de la Tesis}
\label{sec:estructura_tesis}

El resto del documento se organiza de la siguiente manera: El Cap\'itulo 2 presenta el marco te\'orico, estableciendo los fundamentos cient\'ificos y matem\'aticos que sustentan el trabajo, incluyendo formaci\'on de imagen radiogr\'afica mediante atenuaci\'on de rayos X, arquitecturas de redes neuronales convolucionales y transferencia de aprendizaje, an\'alisis de forma mediante Procrustes, triangulaci\'on de Delaunay, deformaci\'on geom\'etrica, y m\'etricas de evaluaci\'on para regresi\'on de puntos de referencia y clasificaci\'on. El Cap\'itulo 4 describe la metodolog\'ia propuesta en detalle, documentando el dise\~no del sistema completo, la arquitectura de los modelos de detecci\'on de puntos de referencia y clasificaci\'on, el protocolo de entrenamiento con aumento de datos y regularizaci\'on, el proceso de normalizaci\'on geom\'etrica tri\'angulo por tri\'angulo, la generaci\'on del conjunto de datos deformado, y el flujo de inferencia de extremo a extremo. El Cap\'itulo 5 presenta los resultados experimentales, enfoc\'andose en tres aspectos clave: la precisi\'on del modelo de puntos de referencia evaluada mediante error en p\'ixeles sobre 96 im\'agenes con anotaciones de referencia, la mejora en clasificaci\'on atribuible a la normalizaci\'on geom\'etrica mediante comparaci\'on directa contra m\'etodos alternativos de preprocesamiento, y la robustez del sistema analizada mediante validaci\'on cruzada, matrices de confusi\'on y an\'alisis de casos mal clasificados. Finalmente, el Cap\'itulo 6 sintetiza las conclusiones del trabajo, analizando la evidencia sobre la efectividad de la normalizaci\'on geom\'etrica para mejorar sistemas de detecci\'on de neumon\'ia, validando la hip\'otesis central mediante m\'etricas cuantitativas, discutiendo las implicaciones pr\'acticas para sistemas de apoyo al diagn\'ostico, reconociendo limitaciones del enfoque propuesto relacionadas con dependencia en la calidad de predicci\'on de puntos de referencia y generalizaci\'on a otros conjuntos de datos, e identificando direcciones prometedoras para investigaci\'on futura.
