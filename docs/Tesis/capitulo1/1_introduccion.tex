% =============================================================================
% CAPITULO 1: INTRODUCCION
% =============================================================================

\chapter{Introducci\'on}
\label{cap:introduccion}

La neumon\'ia representa una de las principales causas de mortalidad a nivel mundial, con millones de casos anuales que requieren diagn\'ostico oportuno y preciso. La pandemia de COVID-19 evidenci\'o la necesidad cr\'itica de m\'etodos de detecci\'on autom\'atica basados en radiograf\'ias de t\'orax, especialmente en entornos con recursos limitados donde el acceso a especialistas es escaso. En este contexto, el desarrollo de sistemas automatizados con alta exactitud y robustez es fundamental para apoyar efectivamente la toma de decisiones cl\'inicas, reduciendo la variabilidad inherente en la interpretaci\'on manual de im\'agenes radiogr\'aficas y permitiendo diagn\'osticos oportunos que pueden salvar vidas \cite{who2020chest}.

La importancia de contar con algoritmos de alta precisi\'on trasciende las m\'etricas num\'ericas: un diagn\'ostico err\'oneo tiene consecuencias tangibles y severas. Un falso negativo en COVID-19 puede resultar en propagaci\'on inadvertida de la enfermedad, poniendo en riesgo a comunidades enteras, mientras que un falso positivo genera costos innecesarios, ansiedad en pacientes y saturaci\'on de sistemas de salud. Por ello, los sistemas de diagn\'ostico automatizado deben demostrar no solo alta precisi\'on en condiciones controladas, sino tambi\'en robustez ante la variabilidad real en la adquisici\'on de im\'agenes: diferencias en el posicionamiento del paciente, distancia de proyecci\'on, calibraci\'on de equipos, fase respiratoria y calidad de imagen. La confiabilidad cl\'inica de estos sistemas depende de su capacidad de mantener performance consistente frente a esta variabilidad extr\'inseca.

Un desaf\'io fundamental en la clasificaci\'on autom\'atica de radiograf\'ias de t\'orax es precisamente esta variabilidad geom\'etrica y de pose. Dos radiograf\'ias del mismo paciente pueden presentar diferencias significativas en la orientaci\'on, escala y posici\'on de las estructuras pulmonares debido a factores no relacionados con la patolog\'ia. Esta variabilidad extr\'inseca dificulta el aprendizaje de caracter\'isticas patol\'ogicas intr\'insecas por parte de modelos de aprendizaje profundo (\textit{deep learning}), que pueden confundir diferencias de pose con diferencias diagn\'osticas o, peor a\'un, aprender correlaciones espurias basadas en artefactos de adquisici\'on en lugar de patrones patol\'ogicos genuinos \cite{geirhos2020shortcut}.

Diversos trabajos han abordado la detecci\'on autom\'atica de COVID-19 y neumon\'ia mediante aprendizaje profundo. Wang et al.\ \cite{wang2020covidnet} desarrollaron COVIDNet, una arquitectura de red neuronal convolucional (\textit{Convolutional Neural Network}, CNN) dise\~nada espec\'ificamente para clasificaci\'on multi-clase de COVID-19, neumon\'ia viral y neumon\'ia bacteriana, alcanzando 93.3\% de exactitud. Rajpurkar et al.\ \cite{rajpurkar2017chexnet} demostraron que CheXNet, basada en DenseNet-121, alcanza performance comparable a radi\'ologos en detecci\'on de neumon\'ia. Estos enfoques aplican redes neuronales convolucionales directamente sobre im\'agenes originales o con preprocesamiento de contraste, sin normalizaci\'on geom\'etrica expl\'icita. Aunque alcanzan alta exactitud en datasets de entrenamiento, su dependencia en caracter\'isticas de apariencia puede limitar su capacidad de generalizaci\'on a datos de hospitales o protocolos de adquisici\'on diferentes.

Estudios recientes han demostrado que la normalizaci\'on geom\'etrica puede mejorar significativamente el rendimiento de clasificadores m\'edicos. Picazo-Castillo et al.\ \cite{picazo2024comparative} presentaron un estudio comparativo de representaciones de im\'agenes pulmonares para reconocimiento autom\'atico de neumon\'ia, demostrando que diferentes estrategias de normalizaci\'on espacial afectan la capacidad de generalizaci\'on de modelos CNN. Ayala-Raggi et al.\ \cite{ayala2023synergizing} propusieron la integraci\'on de normalizaci\'on de im\'agenes de t\'orax con selecci\'on discriminativa de caracter\'isticas basada en An\'alisis de Componentes Principales (\textit{Principal Component Analysis}, PCA) para reconocimiento eficiente de COVID-19, logrando mejoras en exactitud mediante la reducci\'on de variabilidad extr\'inseca. Rocha et al.\ \cite{rocha2024stern} desarrollaron STERN, una red que combina Spatial Transformer Networks con mecanismos de atenci\'on para detecci\'on de anomal\'ias en radiograf\'ias de t\'orax, permitiendo alineaci\'on impl\'icita de regiones anat\'omicas. Yeh et al.\ \cite{yeh2021deep} demostraron que la detecci\'on autom\'atica de puntos de referencia anat\'omicos y su uso para an\'alisis de alineaci\'on mejora significativamente el diagn\'ostico en radiograf\'ias de columna vertebral. Estos trabajos establecen que la reducci\'on de variabilidad extr\'inseca mediante normalizaci\'on espacial es una estrategia viable para mejorar la robustez de clasificadores.

Sin embargo, los trabajos previos se limitan a transformaciones r\'igidas (rotaci\'on, traslaci\'on) o afines globales, que asumen uniformidad en la deformaci\'on del tejido pulmonar. Esta suposici\'on es inexacta dado que el pulm\'on es un \'organo deformable cuya forma var\'ia seg\'un la fase respiratoria, posici\'on del paciente y patolog\'ia subyacente. Una transformaci\'on global que rota o escala la imagen completa puede alinear aproximadamente las estructuras pulmonares, pero no captura la variabilidad local en la forma y expansi\'on de diferentes regiones del pulm\'on.

Este trabajo propone un enfoque m\'as robusto de normalizaci\'on geom\'etrica basado en \textit{deformaci\'on af\'in por partes} (\textit{piecewise affine warping}) de la regi\'on pulmonar. A diferencia de m\'etodos que solo rotan, trasladan o escalan la imagen de forma global, el m\'etodo propuesto \textbf{deforma localmente la regi\'on pulmonar} para adaptarla a una forma est\'andar com\'un, permitiendo que diferentes regiones se transformen de manera independiente mientras se preserva la informaci\'on diagn\'ostica contenida en la textura local. Esta estrategia busca eliminar variabilidad de pose y geometr\'ia sin sacrificar patrones patol\'ogicos intr\'insecos como opacidades en vidrio esmerilado, consolidaciones e infiltrados intersticiales caracter\'isticos de COVID-19 y neumon\'ia viral.

El sistema propuesto integra cuatro componentes principales en un pipeline coherente. Primero, se utiliza un modelo CNN basado en ResNet-18 con Coordinate Attention para predecir autom\'aticamente 15 puntos de referencia anat\'omicos (\textit{landmarks}) que definen el contorno bilateral del pulm\'on. El modelo se entrena mediante regresi\'on directa de coordenadas utilizando Wing Loss, una funci\'on de p\'erdida especializada que amplifica la sensibilidad a errores peque\~nos de localizaci\'on. Segundo, se aplica An\'alisis General de Procrustes (\textit{Generalized Procrustes Analysis}, GPA) sobre las configuraciones de puntos de referencia del conjunto de entrenamiento para calcular una forma est\'andar pulmonar que representa el consenso geom\'etrico de la poblaci\'on, eliminando variaciones de traslaci\'on, rotaci\'on y escala. Tercero, se construye una malla de tri\'angulos mediante triangulaci\'on de Delaunay sobre los puntos de referencia de la forma est\'andar y de cada imagen individual, y se aplica una transformaci\'on af\'in independiente a cada tri\'angulo para mapear la informaci\'on de intensidad de p\'ixeles de la imagen original a la forma est\'andar. Esta deformaci\'on tri\'angulo por tri\'angulo permite adaptaci\'on local preservando continuidad geom\'etrica. Finalmente, las im\'agenes normalizadas geom\'etricamente se procesan mediante un clasificador ResNet-18 entrenado para discriminar entre COVID-19, neumon\'ia viral y casos normales.

La evaluaci\'on experimental del sistema propuesto demuestra su viabilidad t\'ecnica y efectividad. El modelo de detecci\'on de puntos de referencia, utilizando un ensamble de cuatro redes entrenadas con diferentes semillas aleatorias y combinando predicciones mediante aumento de datos en tiempo de prueba (\textit{Test-Time Augmentation}, TTA) con correcci\'on de simetr\'ia bilateral, alcanza un error promedio de 3.61 p\'ixeles en im\'agenes de 224$\times$224 p\'ixeles, equivalente a 1.6\% del tama\~no de imagen. Esta precisi\'on es comparable a trabajos de detecci\'on de puntos de referencia faciales y notable considerando la mayor variabilidad anat\'omica y patol\'ogica en radiograf\'ias de t\'orax. El clasificador entrenado sobre im\'agenes normalizadas alcanza 98.10\% de exactitud en el conjunto de prueba, con F1-Score macro de 97.17\% y validaci\'on cruzada (\textit{cross-validation}) de 5 folds de 98.60\% $\pm$ 0.26\%. El an\'alisis de robustez revela que la normalizaci\'on geom\'etrica facilita el aprendizaje de caracter\'isticas genuinas relacionadas con patolog\'ia en lugar de artefactos de adquisici\'on, evidenciado por la degradaci\'on controlada de performance al eliminar regiones perif\'ericas que potencialmente contienen correlaciones espurias.

El resto del documento se organiza de la siguiente manera. El Cap\'itulo 2 presenta el marco te\'orico, estableciendo los fundamentos de formaci\'on de imagen radiogr\'afica, arquitecturas de redes neuronales convolucionales, an\'alisis de forma mediante Procrustes, triangulaci\'on de Delaunay, deformaci\'on geom\'etrica y m\'etricas de evaluaci\'on. El Cap\'itulo 3 revisa el estado del arte en detecci\'on de COVID-19 mediante aprendizaje profundo, detecci√≥n de puntos de referencia anat\'omicos en im\'agenes m\'edicas, normalizaci\'on geom\'etrica y mecanismos de atenci\'on, posicionando este trabajo en el contexto de la literatura actual e identificando brechas que motivan la investigaci\'on. El Cap\'itulo 4 describe la metodolog\'ia propuesta en detalle, documentando la arquitectura de los modelos, el protocolo de entrenamiento, el proceso de normalizaci\'on geom\'etrica y el flujo de inferencia completo. El Cap\'itulo 5 presenta los resultados experimentales, enfoc\'andose en la precisi\'on del modelo de puntos de referencia, la mejora en clasificaci\'on atribuible a la normalizaci\'on geom\'etrica, y el an\'alisis de robustez mediante validaci\'on cruzada y perturbaciones controladas. Finalmente, el Cap\'itulo 6 sintetiza las conclusiones del trabajo, analiza la evidencia sobre la efectividad de la normalizaci\'on geom\'etrica para mejorar sistemas de detecci\'on de neumon\'ia, reconoce limitaciones del enfoque propuesto e identifica direcciones prometedoras para investigaci\'on futura.
